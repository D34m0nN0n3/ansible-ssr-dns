# Стратегия развертывания, пере развертывания

Порядок действий необходимых для достижения конечного результата.

## Развертывание

Проводится установка и настройка нового комплекса или тестового с восстановлением конфигурации, без замены узлов находящихся в эксплуатации.

Порядок действий:

1. Развернуть на узлах ОС и настроить сеть.
2. Описать параметры узлов в `inventory`.
3. Выполнить роль по установке и настройке.
4. Проверить корректность и работоспособность конфигурации.

## Пере развертывание

Проводится установка и настройка комплекса с восстановлением конфигурации, с замены узлов находящихся в эксплуатации. Предполагается два вариант: единовременная замена всех узлов (динамическая на основе состояния параметров хоста), последовательна замена узлов (статически описанное состояние переменных для узлов).

### Единовременная замена всех узлов (требуется простой сервиса).

1. Развернуть на узлах ОС и настроить сеть. Аналогично заменяемому комплексу.
2. Описать параметры узлов в `inventory`.
3. Выполнить роль по установке и настройке.
4. Проверить корректность и работоспособность конфигурации.
5. Выключение узлов или отключение от сети заменяемого комплекса.
6. На новых узлах настраивается имена узлов и параметры сети такие же как на заменяемом комплексе.
7. Выполнить роль по установке и настройке повторно с параметром `bind_acl_change = True`.
8. Проверить корректность и работоспособность конфигурации.

### Последовательна замена узлов (без простоя сервиса).

1. Развернуть на узлах ОС и настроить сеть. Аналогично заменяемому комплексу.
2. Описать параметры узлов в `inventory`.
3. Выполнить роль по установке и настройке.
4. Проверить корректность и работоспособность конфигурации.
5. Определение переменных для переопределения значений конфигурационных файлах.
6. Выполнить роль по установке и настройке повторно с параметром `bind_acl_change = True`.
7. Проверить корректность и работоспособность конфигурации.
8. Заменить настройки (выполняется последовательно на узлах).  
  8.1 Выключение узла или отключение от сети заменяемого комплекса.
  8.2 На новых узлах настраивается имена узлов и параметры сети такие же как на заменяемом комплексе.
